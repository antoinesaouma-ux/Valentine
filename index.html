<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pour toi ðŸ’˜</title>
  <style>
    :root{
      --bg: #0f1020;
      --card-bg: linear-gradient(180deg,#161626 0%, #0f1120 100%);
      --text: #ecebf6;
      --muted: #9b9bb3;
      --accent: #ff6fa3;
      --cat-scale: 2; /* ajuste ici la taille des chats (1 = natif, 2 = 2x, etc.) */
      --gif-width: 160px;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,Helvetica;display:flex;align-items:center;justify-content:center;}
    .container{
      width:min(820px,92vw);
      padding:36px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .card{
      width:100%;
      max-width:720px;
      background:var(--card-bg);
      border-radius:16px;
      padding:28px;
      box-shadow: 0 8px 30px rgba(3,6,23,0.6);
      position:relative;
      overflow:visible;
      text-align:center;
    }
    h1{margin:0 0 12px 0;font-size:22px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .response { margin-top:14px; color:var(--text); }

    .actions{display:flex;gap:12px;align-items:center;margin-top:18px;justify-content:center;}
    button.btn{
      background:transparent;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.06);
      padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700;
      min-width:88px;
      transition: transform 160ms ease, opacity 160ms ease;
    }
    button.btn.yes{background:linear-gradient(90deg,#ff7aac,#ff4f9a);border:none;color:white}
    button.btn.no{background:transparent}

    /* GIF wrapper - positioned relative to card and centered */
    .gif-wrap{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:18px; /* au-dessus du message principal */
      pointer-events:none;
      z-index:60;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
    }
    .celebration-gif{
      width:var(--gif-width);
      max-width:44vw;
      border-radius:12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      opacity:0;
      transform:translateY(-8px) scale(0.98);
      transition:opacity 220ms ease, transform 220ms ease;
      pointer-events:auto;
      cursor:pointer;
    }
    .celebration-gif.show{
      opacity:1;
      transform:translateY(0) scale(1);
    }
    .gif-close{
      background:rgba(0,0,0,0.45);
      color:white;
      border:none;
      padding:6px 8px;
      border-radius:8px;
      font-weight:700;
      cursor:pointer;
      pointer-events:auto;
    }

    /* message temporaire ajoutÃ© quand GIF visible */
    .celebration-msg{
      margin-top:8px;
      color:#fff;
      font-weight:700;
      background:linear-gradient(90deg,#ff9bbb,#ff6fa3);
      padding:8px 12px;
      border-radius:10px;
      box-shadow:0 6px 20px rgba(255,111,150,0.12);
      pointer-events:none;
      transform-origin:center;
      opacity:0;
      transform:translateY(-6px) scale(0.99);
      transition:opacity 220ms ease, transform 220ms ease;
    }
    .celebration-msg.show{ opacity:1; transform:translateY(0) scale(1); }

    /* petits chats (canvas) container (z-index bas) */
    .cats-layer{ position:absolute; inset:0; pointer-events:none; z-index:10; overflow:visible; }

    @media (max-width:420px){
      :root { --gif-width: 140px; }
      .card{ padding:20px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" id="card">
      <h1>Tu veux un petit secret ?</h1>
      <p class="lead">Clique oui si tu es prÃªtÂ·e ðŸ’Œ</p>

      <div class="actions">
        <button class="btn yes" id="yesBtn">Oui</button>
        <button class="btn no" id="noBtn">Non</button>
      </div>

      <p class="response" id="response">Je suis lÃ  pour toi. Disâ€‘moi si tu veux que je t'aide.</p>

      <!-- zone pour le GIF et le message de cÃ©lÃ©bration -->
      <!-- insÃ©rÃ©e dynamiquement dans JS -->

      <!-- calque pour les chats (script placera des canvases / images ici) -->
      <div class="cats-layer" id="catsLayer"></div>
    </div>
  </div>

  <script>
    /* ============================
       Configuration & utilitaires
       ============================ */
    const card = document.getElementById('card');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const responseP = document.getElementById('response');
    const catsLayer = document.getElementById('catsLayer');

    const GIF_SRC = 'image/love-mochi.gif';
    const CAT_SRC = 'image/cat.png'; // sprite-sheet (si tu utilises une sprite)
    const CSS_CAT_SCALE = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--cat-scale')) || 2;

    // compte pour les clics "Non"
    let noClicks = 0;
    let catsSpawned = false;
    let activeGifWrap = null;
    let celebrationMsgEl = null;

    /* simple toast interne (petit message temporaire en bas) */
    function showToast(text, ms=1200){
      const t = document.createElement('div');
      t.textContent = text;
      Object.assign(t.style, {
        position: 'fixed', left:'50%', transform:'translateX(-50%)',
        bottom:'28px', background:'rgba(0,0,0,0.5)', color:'#fff',
        padding:'8px 12px', borderRadius:'10px', zIndex:120, fontWeight:700
      });
      document.body.appendChild(t);
      setTimeout(()=> { t.style.opacity = '0'; t.addEventListener('transitionend', ()=> t.remove()); }, ms);
    }

    /* ============================
       Comportement bouton NON (3 clics)
       ============================ */
    noBtn.addEventListener('click', () => {
      noClicks++;
      if (noClicks === 1){
        responseP.textContent = "Je pense que tu as dÃ» te tromperâ€¦ rÃ©essaie ðŸ˜‰";
        noBtn.style.transform = 'scale(0.92)';
        showToast("Essaie encore", 900);
      } else if (noClicks === 2){
        responseP.textContent = "Non vraiment, j'insiste â€” essaie encore ðŸ˜¼";
        noBtn.style.transform = 'scale(0.78)';
        showToast("Tu peux le faire", 900);
      } else {
        responseP.textContent = "Bonâ€¦ d'accord, je me tais. Regarde plutÃ´t Ã§a !";
        // faire "fuir" le bouton (animation) puis supprimer
        noBtn.style.transition = 'transform 220ms ease, left 220ms ease, top 220ms ease';
        noBtn.style.transform = 'translateX(160px) translateY(-6px) scale(0.5)';
        setTimeout(()=> noBtn.remove(), 260);
        // spawn des chats une fois seulement
        if (!catsSpawned) {
          spawnSomeCats(8);
          catsSpawned = true;
        }
      }
    });

    /* ============================
       Comportement bouton OUI + GIF
       ============================ */
    yesBtn.addEventListener('click', () => {
      // si un GIF est dÃ©jÃ  prÃ©sent, ne rien faire
      if (activeGifWrap) return;

      // masquer le message en-dessous
      responseP.style.visibility = 'hidden';

      // crÃ©er wrapper gif
      const wrap = document.createElement('div');
      wrap.className = 'gif-wrap';
      wrap.style.pointerEvents = 'none'; // on autorisera les enfants Ã  recevoir les events
      // image
      const img = document.createElement('img');
      img.src = GIF_SRC;
      img.alt = 'Celebrate';
      img.className = 'celebration-gif';
      // close button
      const close = document.createElement('button');
      close.className = 'gif-close';
      close.textContent = 'X';

      // message de cÃ©lÃ©bration
      const cm = document.createElement('div');
      cm.className = 'celebration-msg';
      cm.textContent = 'Je le savais ! Je n\'ai jamais doutÃ© de toi';

      // ordre : gif + close (overlay) + message (sous le gif)
      wrap.appendChild(img);
      wrap.appendChild(close);
      wrap.appendChild(cm);

      // pointer events pour les enfants
      wrap.style.pointerEvents = 'auto';

      // insÃ©rer dans la card
      card.appendChild(wrap);
      activeGifWrap = wrap;
      celebrationMsgEl = cm;

      // petit dÃ©lai pour transition show
      requestAnimationFrame(()=>{
        img.classList.add('show');
        cm.classList.add('show');
      });

      // handlers pour fermer / restaurer le message
      function removeCelebration(){
        if (!activeGifWrap) return;
        img.classList.remove('show');
        cm.classList.remove('show');
        setTimeout(()=>{
          // restore original message
          responseP.style.visibility = 'visible';
          // cleanup
          wrap.remove();
          activeGifWrap = null;
          celebrationMsgEl = null;
        }, 260);
      }

      close.addEventListener('click', removeCelebration);
      img.addEventListener('click', removeCelebration);

      // auto-dismiss aprÃ¨s 6000ms
      wrap._timer = setTimeout(removeCelebration, 6000);
    });

    /* ============================
       Chats : spawn simple (images) et fuite souris
       ============================ */
    function spawnSomeCats(n=6){
      // simple crÃ©ation d'images "chat" qui se dÃ©placent alÃ©atoirement et fuient la souris
      for (let i=0;i<n;i++){
        const img = document.createElement('img');
        img.src = CAT_SRC;
        img.alt = 'chat';
        img.style.position = 'absolute';
        img.style.width = Math.round(24 * CSS_CAT_SCALE) + 'px'; // taille basÃ©e sur la variable
        img.style.height = 'auto';
        img.style.left = (10 + Math.random() * 80) + '%';
        img.style.top = (40 + Math.random() * 50) + '%';
        img.style.transform = 'translate(-50%,-50%)';
        img.style.transition = 'transform 420ms ease, left 400ms ease, top 400ms ease';
        img.style.zIndex = 20;
        img.style.pointerEvents = 'none';
        catsLayer.appendChild(img);

        // comportement : au survol de la souris sur la window, fuir
        function flee(e){
          // calc distance
          const rect = img.getBoundingClientRect();
          const cx = rect.left + rect.width/2;
          const cy = rect.top + rect.height/2;
          const dx = cx - e.clientX;
          const dy = cy - e.clientY;
          const dist = Math.sqrt(dx*dx + dy*dy);
          // si souris trop proche, sauter loin
          if (dist < 160){
            const signX = Math.sign(dx) || (Math.random() < 0.5 ? -1 : 1);
            const signY = Math.sign(dy) || (Math.random() < 0.5 ? -1 : 1);
            const newLeft = Math.min(98, Math.max(2, (parseFloat(img.style.left) + signX * (8 + Math.random()*18))));
            const newTop  = Math.min(96, Math.max(28, (parseFloat(img.style.top) + signY * (6 + Math.random()*12))));
            img.style.left = newLeft + '%';
            img.style.top = newTop + '%';
          }
        }

        // attache l'Ã©vÃ¨nement global (lÃ©ger)
        window.addEventListener('mousemove', flee);

        // stockage cleanup sur l'Ã©lÃ©ment
        img._cleanup = () => window.removeEventListener('mousemove', flee);
      }
    }

    /* cleanup quand on quitte (bonne pratique) */
    window.addEventListener('beforeunload', ()=>{
      // supprimer listeners attachÃ©s par spawnSomeCats
      const imgs = catsLayer.querySelectorAll('img');
      imgs.forEach(im => {
        if (im._cleanup) im._cleanup();
      });
    });

    /* ============================
       Fin
       ============================ */
  </script>
</body>
</html>
